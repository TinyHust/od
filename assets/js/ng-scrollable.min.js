/**
 * ng-scrollable - Superamazing scrollbars for AngularJS
 * @version 0.2.6 - built on 2017-04-22
 * @link https://echa.github.io/ng-scrollable/
 * @license MIT License, Copyright (c) 2017 Alexander Eichhorn <alex@kidtsunami.com>
 */
angular.module("ngScrollable",[]).directive("ngScrollable",["$injector",function(a){"use strict";var b=a.get("$rootScope"),c=a.get("$document"),d=a.get("$interval"),e=a.get("$timeout"),f=a.get("$window"),g=a.get("$parse"),h=angular.bind,i=angular.extend,j=angular.element,k=(angular.isDefined,"undefined"!=typeof f.ontouchstart),l="transform",m=f.requestAnimationFrame||f.webkitRequestAnimationFrame,n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;["webkit","moz","o","ms"].every(function(a){var b=a+"Transform",d=c.find("body").eq(0);return"undefined"!=typeof d[0].style[b]?(l=b,!1):!0});var o={id:0,events:"broadcast",scrollX:"bottom",scrollY:"right",scrollXSlackSpace:0,scrollYSlackSpace:0,scrollXAlways:!1,scrollYAlways:!1,usePadding:!1,useObserver:!0,wheelSpeed:1,minSliderLength:10,useBothWheelAxes:!1,useKeyboard:!0,preventKeyEvents:!0,preventWheelEvents:!1,updateOnResize:!0,kineticTau:325,spyMargin:1};return{restrict:"A",transclude:!0,template:"<div class=\"scrollable\"><div class=\"scrollable-content\" ng-transclude></div><div class='scrollable-bar scrollable-bar-x'><div class='scrollable-slider'></div></div><div class='scrollable-bar scrollable-bar-y'><div class='scrollable-slider'></div></div></div>",link:{post:angular.noop,pre:function(a,p,q){var r,s,t,u,v,w=i({},o,a.$eval(q.ngScrollable)),x=j(p.children()[0]),y={window:j(f),el:x,content:j(x.children()[0]),barX:j(x.children()[1]),barY:j(x.children()[2]),sliderX:j(j(x.children()[1]).children()[0]),sliderY:j(j(x.children()[2]).children()[0])},z=!1,A=!1,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=null,M=null,N=null,O=null,P=!1,Q=!1,R=!1,S={},T=1,U=0,V=0,W=0,X=0,Y=0,Z=0,$=0,_=0,aa=function(a){return a.toFixed(3)+"px"},ba=function(a,b,c){return Math.max(b,Math.min(a,c))},ca=function(){var b=a.$root?a.$root.$$phase:a.$$phase;"$apply"!==b&&"$digest"!==b&&a.$digest()},da=function(){switch(w.events){case"broadcast":a.$broadcast.apply(a,arguments);break;case"emit":a.$emit.apply(a,arguments);break;case"both":a.$broadcast.apply(a,arguments),a.$emit.apply(a,arguments);break;case"rootScope":b.$emit.apply(a,arguments)}},ea=function(){var a=B-3;z||w.scrollXAlways?(H=Math.max(w.minSliderLength,parseInt(a*a/D,10)),I=parseInt(G*(a-H)/(D-a),10),I>=a-H?I=a-H:0>I&&(I=0),y.sliderX[0].style[l]="translate3d("+aa(I)+",0,0)",y.sliderX[0].style.width=aa(H)):(H=I=0,y.sliderX[0].style[l]="translate3d(0,0,0)",y.sliderX[0].style.width="0")},fa=function(){var a=C-3;A||w.scrollYAlways?(J=Math.max(w.minSliderLength,parseInt(a*a/E,10)),K=parseInt(F*(a-J)/(E-a),10),K>=a-J?K=a-J:0>K&&(K=0),y.sliderY[0].style[l]="translate3d(0,"+aa(K)+",0)",y.sliderY[0].style.height=aa(J)):(K=J=0,y.sliderY[0].style[l]="translate3d(0,0,0)",y.sliderY[0].style.height="0")},ga=function(){var a=w.scrollXAlways,b={left:0,width:aa(B),display:z||a?"inherit":"none"};switch(w.scrollX){case"bottom":b.bottom=0,y.content[z||a?"addClass":"removeClass"]("scrollable-bottom"),y.barX[z||a?"addClass":"removeClass"]("scrollable-bottom");break;case"top":b.top=0,y.content[z||a?"addClass":"removeClass"]("scrollable-top"),y.barX[z||a?"addClass":"removeClass"]("scrollable-top")}y.barX.css(b),y.sliderX[0].style.display=z||a?"inherit":"none"},ha=function(){var a=w.scrollYAlways,b={top:0,height:aa(C),display:A||a?"inherit":"none"};switch(w.scrollY){case"right":b.right=0,y.content[A||a?"addClass":"removeClass"]("scrollable-right"),y.barY[A||a?"addClass":"removeClass"]("scrollable-right");break;case"left":b.left=0,y.content[A||a?"addClass":"removeClass"]("scrollable-left"),y.barY[A||a?"addClass":"removeClass"]("scrollable-left")}y.barY.css(b),y.sliderY[0].style.display=A||a?"inherit":"none"},ia=function(){var b=!1;S.spyX&&(S.spyX(a,parseInt(G,10)),b=!0),S.spyY&&(S.spyY(a,parseInt(F,10)),b=!0),b&&ca()},ja=function(b,c){var d=F,e=G;F=ba(c,0,E-C),G=ba(b,0,D-B),(d!==F||e!==G)&&(y.content[0].style[l]="translate3d("+aa(-G)+","+aa(-F)+",0)",a.$applyAsync(ia),C*w.spyMargin>F&&d>=C*w.spyMargin&&da("scrollable.spytop",F,w.id),F>E-C*(w.spyMargin+1)&&E-C*(w.spyMargin+1)>=d&&da("scrollable.spybottom",F,w.id),B*w.spyMargin>G&&e>=B*w.spyMargin&&da("scrollable.spyleft",G,w.id),G>D-B*(w.spyMargin+1)&&D-B*(w.spyMargin+1)>=e&&da("scrollable.spyright",G,w.id))},ka=function(a){z&&(ja(a,F),ea())},la=function(a){A&&(ja(G,a),fa())},ma=function(b,c){B=w.usePadding?y.el[0].clientWidth:y.el[0].offsetWidth,C=w.usePadding?y.el[0].clientHeight:y.el[0].offsetHeight,D=y.content[0].scrollWidth,E=y.content[0].scrollHeight,T=parseFloat(y.window[0].getComputedStyle(y.el[0],null).getPropertyValue("font-size")),"none"!==w.scrollX&&D>B+w.scrollXSlackSpace?z=!0:(ka(0),z=!1),"none"!==w.scrollY&&E>C+w.scrollYSlackSpace?A=!0:(la(0),A=!1),ga(),ha(),ea(),fa(),G+I+H>D&&ka(I),F+K+J>E&&la(K),c||a.$broadcast("scrollable.dimensions",B,C,D,E,w.id)},na=function(a,b){return a.stopPropagation(),b&&a.preventDefault(),!1},oa=function(a){return a=a.originalEvent||a,a.targetTouches&&a.targetTouches.length>=1?a.targetTouches[0].pageY:a.pageY},pa=function(a){return a=a.originalEvent||a,a.targetTouches&&a.targetTouches.length>=1?a.targetTouches[0].pageX:a.pageX},qa=function(){var a,b,c,d;a=Date.now(),b=a-u,u=a,c=G-W,W=G,d=1e3*c/(1+b),U=.8*d+.2*U,c=F-$,$=F,d=1e3*c/(1+b),Y=.8*d+.2*Y},ra=function(){var a,b;V&&(a=Date.now()-u,b=-V*Math.exp(-a/w.kineticTau),b>.5||-.5>b?(ka(X+b),m(ra)):ka(X))},sa=function(){var a,b;Z&&(a=Date.now()-u,b=-Z*Math.exp(-a/w.kineticTau),b>.5||-.5>b?(la(_+b),m(sa)):la(_))},ta=function(a){if(P){var b=pa(a)-M,c=k?-b:parseInt(b*(D-B)/(B-H),10);return m(h(null,ka,L+c)),k||na(a,!0)}},ua=function(a){return P&&(c.off("mousemove",ta),c.off("mouseup",ua),P=!1,y.el.removeClass("active"),L=M=null),v&&(d.cancel(v),v=null),(U>10||-10>U)&&(V=.8*U,X=Math.round(G+V),u=Date.now(),m(ra)),k||na(a,!0)},va=function(a){return M=pa(a),L=G,P=!0,U=V=0,W=G,c.on("mousemove",ta),c.on("mouseup",ua),k&&!v&&(v=d(qa,50)),y.el.addClass("active"),k||na(a,!0)},wa=function(a){if(Q){var b=oa(a)-O,c=k?-b:parseInt(b*(E-C)/(C-J),10);return m(h(null,la,N+c)),k||na(a,!0)}},xa=function(a){return Q&&(c.off("mousemove",wa),c.off("mouseup",xa),Q=!1,y.el.removeClass("active"),N=O=null),v&&(d.cancel(v),v=null),(Y>10||-10>Y)&&(Z=.8*Y,_=Math.round(F+Z),u=Date.now(),m(sa)),k||na(a,!0)},ya=function(a){return O=oa(a),N=F,Q=!0,Y=Z=0,$=F,c.on("mousemove",wa),c.on("mouseup",xa),k&&!v&&(v=d(qa,50)),y.el.addClass("active"),k||na(a,!0)},za=function(a){var b=parseInt(H/2,10),c=a.clientX-y.barX[0].getBoundingClientRect().left-b,d=B-H,e=ba(c/d,0,1);m(h(null,ka,(D-B)*e))},Aa=function(a){var b=parseInt(J/2,10),c=a.clientY-y.barY[0].getBoundingClientRect().top-b,d=C-J,e=ba(c/d,0,1);m(h(null,la,(E-C)*e))},Ba=function(){R=!0},Ca=function(){R=!1},Da=function(a){var b=0,d=0,e=30;if(!(!R||c[0].activeElement.isContentEditable||"INPUT"===c[0].activeElement.nodeName||a.altKey||a.ctrlKey||a.metaKey)){switch(a.which){case 37:b=-e;break;case 38:d=e;break;case 39:b=e;break;case 40:d=-e;break;case 33:d=C;break;case 32:case 34:d=-C;break;case 35:A&&!z?d=-E:b=C;break;case 36:A&&!z?d=E:b=-C;break;default:return}m(h(null,la,F-d)),m(h(null,ka,G+b)),w.preventKeyEvents&&a.preventDefault()}},Ea=function(a){var b=a.explicitOriginalTarget||a.target;if(!b)return!1;if(b.isContentEditable)return b.scrollHeight>b.clientHeight+b.clientTop+10;for(;b;){if(b.className&&"string"==typeof b.className&&b.className.indexOf("scrollable-ignore")>-1)return!0;b=b.parentNode}return!1},Fa=function(){var a=Date.now()-t;500>a?s=e(Fa,500-a):(y.el.removeClass("active"),s=null)},Ga=function(a){return 0>=G+a||G+a>=D-B},Ha=function(a){return 0>=F+a||F+a>=E-C},Ia=function(a){if(a=a.originalEvent||a,!Ea(a)){var b=a.deltaMode?T:1,c=a.deltaX*b*w.wheelSpeed,d=a.deltaY*b*w.wheelSpeed,f=A||z;if(a.shiftKey){var g=d;d=c,c=g}t=Date.now(),s||(y.el.addClass("active"),s=e(Fa,500)),w.useBothWheelAxes?A&&!z?d?(m(h(null,la,F+d)),f=!Ha(d)):(m(h(null,la,F+c)),f=!Ha(c)):z&&!A&&(c?(m(h(null,ka,G+c)),f=!Ga(c)):(m(h(null,ka,G+d)),f=!Ga(d))):(m(h(null,la,F+d)),m(h(null,ka,G+c)),A&&(f=!Ha(0))),(f||w.preventWheelEvents)&&na(a,!0)}},Ja=function(a){var b=y.el[0].scrollTop,c=y.el[0].scrollLeft;b&&m(h(null,la,F+b+2)),c&&m(h(null,ka,G+c+2)),y.el[0].scrollTop=y.el[0].scrollLeft=0,na(a,!0)},Ka=function(){if(w.useObserver&&n){var a={childList:!0,subtree:!0};r=new n(function(){m(ma)}),r.observe(y.content[0],a)}w.updateOnResize&&y.window.on("resize",ma),"none"!==w.scrollX&&(y.sliderX.on("click",na),y.barX.on("click",za),y.sliderX.on("mousedown",va),k&&(y.el.on("touchstart",va),y.el.on("touchmove",ta),y.el.on("touchend",ua))),"none"!==w.scrollY&&(y.sliderY.on("click",na),y.barY.on("click",Aa),y.sliderY.on("mousedown",ya),k&&(y.el.on("touchstart",ya),y.el.on("touchmove",wa),y.el.on("touchend",xa))),y.el.on("wheel",Ia),y.el.on("scroll",Ja),w.useKeyboard&&(y.el.on("mouseenter",Ba),y.el.on("mouseleave",Ca),c.on("keydown",Da))},La=function(){r&&(r.disconnect(),r=null),w.updateOnResize&&y.window.off("resize",ma),y.sliderX.off("click",na),y.barX.off("click",za),y.sliderY.off("click",na),y.barY.off("click",Aa),k&&(y.el.off("touchstart",va),y.el.off("touchmove",ta),y.el.off("touchend",ua),y.el.off("touchstart",ya),y.el.off("touchmove",wa),y.el.off("touchend",xa)),y.sliderX.off("mousedown",va),c.off("mousemove",ta),c.off("mouseup",ua),y.sliderY.off("mousedown",ya),c.off("mousemove",wa),c.off("mouseup",xa),w.useKeyboard&&(y.el.off("mouseenter",Ba),y.el.off("mouseleave",Ca),c.off("keydown",Da)),y.el.off("wheel",Ia),y.el.off("scroll",Ja)};a.$on("content.reload",function(a,b){La(),e(function(){y.el=j(p.children()[0]),y.content=j(y.el.children()[0]),Ka(),ma(a,b)})}),a.$on("content.changed",function(a,b,c){b=b||100,e(function(){ma(a,c)},b),a.preventDefault()}),a.$on("scrollable.scroll.left",function(){a.$applyAsync(function(){ka(0)})}),a.$on("scrollable.scroll.right",function(){a.$applyAsync(function(){ka(D)})}),a.$on("scrollable.scroll.top",function(){a.$applyAsync(function(){la(0)})}),a.$on("scrollable.scroll.bottom",function(){a.$applyAsync(function(){la(E)})}),a.$on("scrollable.scroll.x",function(b,c){a.$applyAsync(function(){ka(c)})}),a.$on("scrollable.scroll.y",function(b,c){a.$applyAsync(function(){la(c)})}),a.$on("scrollable.scroll.xy",function(b,c,d){a.$applyAsync(function(){la(d),ka(c)})}),a.$on("$destroy",function(){e.cancel(s),La()}),Ka(),ma(),angular.forEach(["spyX","spyY"],function(b){q[b]&&(S[b]=g(q[b]).assign,a.$watch(q[b],function(a){switch(a=a||0,b){case"spyX":ka(a);break;case"spyY":la(a)}}))})}}}}]);